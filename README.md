# singleCellRNA_TSC
the R code of single nucleus RNA data analysis for 4 TSC samples

Single nucleus RNA-sequencing (snRNA-seq)
Single-nucleus RNA-seq was conducted on cortical specimens surgically resected from both non-TSC control and TSC patient, including regions designated as TSC-tuber, TSC-edge (the edge of the tuber), and TSC-outside (outside the tuber). Nuclei isolation from frozen brain tissues was conducted by Azenta (South Plainfield, NJ, USA). Nuclei extraction was carried out using the Miltenyi Nuclei Extraction Buffer (Miltenyi Biotec, Auburn, CA, USA) according to the manufacturer’s guidelines, utilizing gentle MACS Dissociation and C tubes. After isolation, the nuclei were counted using the Nexcelom Cellaca MX. 3’ RNA library preparation and sequencing were performed by generating single nuclei RNA libraries using the Single Cell Multiome ATAC + Gene Expression kit (10X Genomics, CA, USA). Loading onto the Chromium instrument was conducted to target a capture of approximately 10,000 cells per sample for downstream analysis, following the standard specifications provided by the manufacturer.

The sequencing libraries were assessed for quality using the Agilent TapeStation (Agilent Technologies, Palo Alto, CA, USA) and quantified with a Qubit 2.0 Fluorometer (Invitrogen, Carlsbad, CA). Quantification of libraries was further conducted using qPCR (Applied Biosystems, Carlsbad, CA, USA) before loading onto an Illumina HiSeq (4000 or equivalent) instrument. Sequencing of the samples was performed in a configuration compatible with the recommended guidelines outlined by 10X Genomics. Raw sequence data (.bcl files) were converted to fastq files and de-multiplexed using the 10X Genomics' cellranger mkfastq command.

snRNA-seq analyses were processed according to our previous methods 86. The raw sequencing files were processed using CellRanger (v7.1.0) from 10X Genomics to generate the expression matrix for each sample. The reference genome used for raw read alignment was GRCh38, also obtained from 10X Genomics. Single nucleus analysis was performed using Seurat (V4.0) 87. The filtered
